when:
  - event: ["push"]
    branch: ["main"]

engine: "nixery"

dependencies:
  nixpkgs:
    - nodejs
    - go
    - musl

steps:
  - name: Build the site
    command: go run .
    environment:
      GOOS: linux
      GOARCH: amd64
  - name: Deploy the site
    command: npx wrangler deploy
